/*!BuildUpFromNothing-wipe1.0.0 发布日期:2018-11-13*/
var canvas=document.getElementById("cas"),context=canvas.getContext("2d"),_w=canvas.width,_h=canvas.height,radius=20,moveX=0,moveY=0,isMouseDown=!1,device=/android|webos|iPhone|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());console.log(navigator.userAgent);var clickEvtName=device?"touchstart":"mousedown",moveEvtName=device?"touchmove":"mousemove",endEvtName=device?"touchend":"mouseup";function drawMask(e){e.fillStyle="#666",e.fillRect(0,0,_w,_h),e.globalCompositeOperation="destination-out"}function drawT(e,t,n,o,a){if(3===arguments.length)context.save(),context.beginPath(),context.arc(t,n,radius,0,2*Math.PI),context.fillStyle="rgb(242,103,91)",context.fill(),context.restore();else{if(5!==arguments.length)return!1;context.save(),context.lineCap="round",context.beginPath(),context.moveTo(t,n),context.lineTo(o,a),context.lineWidth=2*radius,context.stroke(),context.restore()}}canvas.addEventListener(clickEvtName,function(e){var t=e||window.event;moveX=device?t.touches[0].clientX:t.clientX,moveY=device?t.touches[0].clientY:t.clientY,drawT(context,moveX,moveY),isMouseDown=!0},!1),canvas.addEventListener(moveEvtName,function(e){if(isMouseDown){var t=e||window.event;t.preventDefault();var n=device?t.touches[0].clientX:t.clientX,o=device?t.touches[0].clientY:t.clientY;drawT(context,moveX,moveY,n,o),moveX=n,moveY=o}},!1),canvas.addEventListener(endEvtName,function(){t=0,isMouseDown=!1,50<getTransparency(context)&&grawClear(context)},!1);var t=0;function getTransparency(e){for(var n=e.getImageData(0,0,_w,_h),o=0;o<n.data.length;o+=4){0===n.data[o+3]&&t++}return console.log("透明点的个数："+t),console.log("占总面积："+(t/(_w*_h)*100).toFixed(2)+"%"),(t/(_w*_h)*100).toFixed(2)}function grawClear(e){e.clearRect(0,0,_w,_h)}window.onload=function(){drawMask(context)};